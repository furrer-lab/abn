<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en, de, fr">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="description" content="abn">
<title>Quick Start Example • abn</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Quick Start Example">
<meta property="og:description" content="abn">
<meta property="og:image" content="http://r-bayesian-networks.org/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">abn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="active nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/quick_start_example.html">Quick Start Example</a>
    <a class="dropdown-item" href="../articles/model_specification.html">Model Specification: Build a Cache of Scores</a>
    <a class="dropdown-item" href="../articles/structure_learning.html">Bayesian Network Structure Learning</a>
    <a class="dropdown-item" href="../articles/parameter_learning.html">Parameter Learning</a>
    <a class="dropdown-item" href="../articles/mixed_effect_BN_model.html">Mixed-effect Bayesian Network Model</a>
    <a class="dropdown-item" href="../articles/data_simulation.html">Data Simulation</a>
    <a class="dropdown-item" href="../articles/multiprocessing.html">Parallelisation</a>
    <a class="dropdown-item" href="../articles/paper.html">Additive Bayesian Networks</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul>
<form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off">
</form>

      <ul class="navbar-nav">
<li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/furrer-lab/abn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>

    
  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Quick Start Example</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/furrer-lab/abn/blob/HEAD/vignettes/quick_start_example.Rmd" class="external-link"><code>vignettes/quick_start_example.Rmd</code></a></small>
      <div class="d-none name"><code>quick_start_example.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="http://r-bayesian-networks.org">abn</a></span><span class="op">)</span></span></code></pre></div>
<p>This vignette covers the whole process of Bayesian network structure
learning to parameter estimation and data simulation. # Find the best
fitting graphical structure using an exact search algorithm</p>
<div class="section level2">
<h2 id="basic-workflow-with-the-abn-package">Basic workflow with the <code>abn</code> package<a class="anchor" aria-label="anchor" href="#basic-workflow-with-the-abn-package"></a>
</h2>
<p>The package <code>abn</code> is a collection of functions for
modelling of additive Bayesian networks. It contains routines to score
Bayesian Networks based on Bayesian (default) or information-theoretic
formulation of generalized linear models. Depending on the type of data,
the package supports a possible mixture of continuous, discrete, and
count data. The following table shows which of distribution types are
supported by for each method of estimation:</p>
<table class="table">
<thead><tr class="header">
<th align="left">Distribution type</th>
<th align="center"><code>method = "bayes"</code></th>
<th align="center"><code>method = "mle"</code></th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="left">Gaussian</td>
<td align="center">✅</td>
<td align="center">✅</td>
</tr>
<tr class="even">
<td align="left">Binomial</td>
<td align="center">✅</td>
<td align="center">✅</td>
</tr>
<tr class="odd">
<td align="left">Poisson</td>
<td align="center">✅</td>
<td align="center">✅</td>
</tr>
<tr class="even">
<td align="left">Multinomial</td>
<td align="center">❌</td>
<td align="center">✅</td>
</tr>
</tbody>
</table>
<p>Structure learning of additive Bayesian networks with
<code>abn</code> is a three-step process. Based on a set of model
specifications (data, maximal number of possible parent nodes,
restricted or enforced arcs, etc.), <code>abn</code> calculates in a
first step the score of the data given the model
(<code><a href="../reference/buildScoreCache.html">buildScoreCache()</a></code>). This list of scores is then used to
estimate the most probable Bayesian network structure (“structure
learning”) and to infer the network structure in a third step
(<code><a href="../reference/fitAbn.html">fitAbn()</a></code>). Four structure-learning algorithms have been
implemented in <code>abn</code>: the hill-climbing algorithm, the “exact
search” algorithm, the simulated annealing algorithm and tabu search
algorithm. With the network structure inferred, the package provides
routines to estimate the parameters of the network and to simulate data
from the fitted additive Bayesian network model.</p>
<p>The following example shows how to find the best fitting graphical
structure using an exact search algorithm.</p>
</div>
<div class="section level2">
<h2 id="model-specification">Model specification<a class="anchor" aria-label="anchor" href="#model-specification"></a>
</h2>
<div class="section level3">
<h3 id="load-the-example-dataset-ex1-dag-data">Load the example dataset <code>ex1.dag.data</code><a class="anchor" aria-label="anchor" href="#load-the-example-dataset-ex1-dag-data"></a>
</h3>
<p>This artificial data set comes with <code>abn</code> and contains
10000 observations of 10 variables. The variables are a mixture of
continuous (<code>gaussian</code>), binary (<code>binomial</code>), and
count (<code>poisson</code>) data. The data set is a simulated data set
from a known network structure.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydat</span> <span class="op">&lt;-</span> <span class="va">ex1.dag.data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">mydat</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level3">
<h3 id="set-up-distribution-list-for-each-node">Set up distribution list for each node<a class="anchor" aria-label="anchor" href="#set-up-distribution-list-for-each-node"></a>
</h3>
<p><code>abn</code> requires a list of the type of distribution for each
node in the data set.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mydists</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b1<span class="op">=</span><span class="st">"binomial"</span>, </span>
<span>                p1<span class="op">=</span><span class="st">"poisson"</span>, </span>
<span>                g1<span class="op">=</span><span class="st">"gaussian"</span>, </span>
<span>                b2<span class="op">=</span><span class="st">"binomial"</span>, </span>
<span>                p2<span class="op">=</span><span class="st">"poisson"</span>, </span>
<span>                b3<span class="op">=</span><span class="st">"binomial"</span>, </span>
<span>                g2<span class="op">=</span><span class="st">"gaussian"</span>, </span>
<span>                b4<span class="op">=</span><span class="st">"binomial"</span>, </span>
<span>                b5<span class="op">=</span><span class="st">"binomial"</span>, </span>
<span>                g3<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span> </span></code></pre></div>
</div>
<div class="section level3">
<h3 id="set-the-parent-limits-node-wise">Set the parent limits node-wise<a class="anchor" aria-label="anchor" href="#set-the-parent-limits-node-wise"></a>
</h3>
<p>The <code>max.par</code> argument sets the maximum number of parent
nodes for each node in the data set. It can be set to a single value for
all nodes or to a list with the node names as keys and the maximum
number of parent nodes as values. This is a crucial parameter to speed
up the model estimation in <code>abn</code> as it limits the number of
possible combinations.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># max.par &lt;- list("b1"=1,"p1"=2,"g1"=3,"b2"=4,"p2"=1,"b3"=2,"g2"=3,"b4"=4,"b5"=1,"g3"=2) # set different max parents for each node</span></span>
<span><span class="va">max.par</span> <span class="op">&lt;-</span> <span class="fl">4</span> <span class="co"># set the same max parents for all nodes</span></span></code></pre></div>
</div>
</div>
<div class="section level2">
<h2 id="build-the-score-cache">Build the score cache<a class="anchor" aria-label="anchor" href="#build-the-score-cache"></a>
</h2>
<p>The score cache is a list of scores for each possible parent
combination for each node in the data set. It is used to learn the
structure of the Bayesian network in the next step.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mycache</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/buildScoreCache.html">buildScoreCache</a></span><span class="op">(</span>data.df <span class="op">=</span> <span class="va">mydat</span>, </span>
<span>                           data.dists <span class="op">=</span> <span class="va">mydists</span>,</span>
<span>                           method <span class="op">=</span> <span class="st">"bayes"</span>, <span class="co"># the default method is "bayes"</span></span>
<span>                           max.parents <span class="op">=</span> <span class="va">max.par</span><span class="op">)</span></span></code></pre></div>
<p>The minimal number of input arguments for
<code><a href="../reference/buildScoreCache.html">buildScoreCache()</a></code> is the data set and the distribution
list. By default, the function uses the Bayesian score which is based on
the posterior probability of the model given the data. To use the
Log-Likelihood score, Akaike Information Criterion (AIC) or Bayesian
Information Criterion (BIC) instead, the <code>method</code> argument
can be set to <code>"mle"</code>.</p>
<p>The function <code><a href="../reference/buildScoreCache.html">buildScoreCache()</a></code> also accepts a list of
banned and retained arcs, which can be used to enforce or restrict the
presence of certain arcs in the network structure. This can be useful if
prior knowledge about the network structure is available, e.g. from
expert knowledge or from previous analyses it is known that certain arcs
must be present or have to be absent.</p>
<p>The <code>max.parents</code> argument sets the maximum number of
parent nodes for each node in the data set and together with the
<code>dag.banned</code> and <code>dag.retained</code> arguments, it
restricts the model search space and can speed up the model estimation
in <code>abn</code>.</p>
</div>
<div class="section level2">
<h2 id="structure-learning">Structure learning<a class="anchor" aria-label="anchor" href="#structure-learning"></a>
</h2>
<p>The next step is to find the best fitting graphical structure of the
Bayesian network. In this example, we use the exact search algorithm to
find the most probable Bayesian network structure given the score cache
from the previous step. We supply the score cache as
<code>abnCache</code> object from the previous step to the structure
learning function.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">mp.dag</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/mostProbable.html">mostProbable</a></span><span class="op">(</span>score.cache <span class="op">=</span> <span class="va">mycache</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/mostProbable.html">mostProbable()</a></code> function returns an object of class
<code>abnLearned</code> which contains the most probable Bayesian
network structure and the score of the model given the data.</p>
<div class="section level3">
<h3 id="plot-the-best-fitting-graphical-structure">Plot the best fitting graphical structure<a class="anchor" aria-label="anchor" href="#plot-the-best-fitting-graphical-structure"></a>
</h3>
<p>The best fitting graphical structure can be plotted using the
<code><a href="../reference/plotAbn.html">plotAbn()</a></code> function.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">mp.dag</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot()</a></code> function requires the <code>Rgraphviz</code>
package to be installed.</p>
</div>
</div>
<div class="section level2">
<h2 id="estimate-the-parameters-of-the-network">Estimate the parameters of the network<a class="anchor" aria-label="anchor" href="#estimate-the-parameters-of-the-network"></a>
</h2>
<p>The parameters of the network can be estimated using the
<code><a href="../reference/fitAbn.html">fitAbn()</a></code> function.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">myfit</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/fitAbn.html">fitAbn</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">mp.dag</span><span class="op">)</span></span></code></pre></div>
<p>The <code><a href="../reference/fitAbn.html">fitAbn()</a></code> function returns an object of class
<code>abnFit</code> which contains the estimated parameters of the
network.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">myfit</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">myfit</span><span class="op">)</span></span></code></pre></div>
</div>
<div class="section level2">
<h2 id="simulate-data-from-the-fitted-model">Simulate data from the fitted model<a class="anchor" aria-label="anchor" href="#simulate-data-from-the-fitted-model"></a>
</h2>
<p>The <code><a href="../reference/simulateAbn.html">simulateAbn()</a></code> function can be used to simulate data
from the fitted model.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">simdat</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/simulateAbn.html">simulateAbn</a></span><span class="op">(</span>object <span class="op">=</span> <span class="va">myfit</span>, </span>
<span>                      n.iter <span class="op">=</span> <span class="fl">10000L</span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/summary.html" class="external-link">summary</a></span><span class="op">(</span><span class="va">simdat</span><span class="op">)</span></span></code></pre></div>
</div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p></p>
<p>Developed by Matteo Delucchi, Reinhard Furrer, Gilles Kratzer, Fraser Iain Lewis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer>
</div>

  

  

  </body>
</html>
