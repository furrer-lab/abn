<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en, de, fr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="A flexible implementation of multiple greedy search algorithms to find high scoring network (DAG)"><title>A family of heuristic algorithms that aims at finding high scoring directed acyclic graphs — searchHeuristic • abn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="A family of heuristic algorithms that aims at finding high scoring directed acyclic graphs — searchHeuristic"><meta property="og:description" content="A flexible implementation of multiple greedy search algorithms to find high scoring network (DAG)"><meta property="og:image" content="http://r-bayesian-networks.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">abn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/quick_start_example.html">Quick Start Example</a>
    <a class="dropdown-item" href="../articles/model_specification.html">Model Specification: Build a Cache of Scores</a>
    <a class="dropdown-item" href="../articles/structure_learning.html">Bayesian Network Structure Learning</a>
    <a class="dropdown-item" href="../articles/parameter_learning.html">Parameter Learning</a>
    <a class="dropdown-item" href="../articles/mixed_effect_BN_model.html">Mixed-effect Bayesian Network Model</a>
    <a class="dropdown-item" href="../articles/data_simulation.html">Data Simulation</a>
    <a class="dropdown-item" href="../articles/multiprocessing.html">Parallelisation</a>
    <a class="dropdown-item" href="../articles/paper.html">Additive Bayesian Networks</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/furrer-lab/abn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>A family of heuristic algorithms that aims at finding high scoring directed acyclic graphs</h1>
      <small class="dont-index">Source: <a href="https://github.com/furrer-lab/abn/blob/HEAD/R/search_heuristic.R" class="external-link"><code>R/search_heuristic.R</code></a></small>
      <div class="d-none name"><code>searchHeuristic.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>A flexible implementation of multiple greedy search algorithms to find high scoring network (DAG)</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">searchHeuristic</span><span class="op">(</span><span class="va">score.cache</span>, score <span class="op">=</span> <span class="st">"mlik"</span>,</span>
<span>                       num.searches <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">42L</span>, start.dag <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>                       max.steps <span class="op">=</span> <span class="fl">100</span>,</span>
<span>                       algo <span class="op">=</span> <span class="st">"hc"</span>, tabu.memory <span class="op">=</span> <span class="fl">10</span>, temperature <span class="op">=</span> <span class="fl">0.9</span>,</span>
<span>                       verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>score.cache</dt>
<dd><p>output from <code><a href="buildScoreCache.html">buildScoreCache()</a></code>.</p></dd>


<dt>score</dt>
<dd><p>which score should be used to score the network. Possible choices are <code>aic, bic, mdl, mlik</code>.</p></dd>


<dt>num.searches</dt>
<dd><p>a positive integer giving the number of different search to run, see details.</p></dd>


<dt>seed</dt>
<dd><p>a non-negative integer which sets the seed.</p></dd>


<dt>start.dag</dt>
<dd><p>a DAG given as a matrix, see details for format, which can be used to explicity provide a starting point for the structural search.</p></dd>


<dt>max.steps</dt>
<dd><p>a constant giving the number of search steps per search, see details.</p></dd>


<dt>algo</dt>
<dd><p>which heuristic algorithm should be used. Possible choices are: <code>hc, tabu, sa</code>.</p></dd>


<dt>tabu.memory</dt>
<dd><p>a non-negative integer number to set the memory of the <code>tabu</code> search.</p></dd>


<dt>temperature</dt>
<dd><p>a real number giving the update in temperature for the <code>sa</code> (simulated annealing) search algorithm.</p></dd>


<dt>verbose</dt>
<dd><p>if TRUE then provides some additional output.</p></dd>


<dt>...</dt>
<dd><p>further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>An object of class <code>abnHeuristic</code> (which extends the class <code>abnLearnd</code>) and contains list with entires:</p><dl><dt>dags</dt>
<dd><p>a list of DAGs</p></dd>

<dt>scores</dt>
<dd><p>a vector giving the network score for the locally optimal network for each search</p></dd>

<dt>detailed.score</dt>
<dd><p>a vector giving the evolution of the network score for the all the random restarts</p></dd>

<dt>score</dt>
<dd><p>a number giving the network score for the locally optimal network</p></dd>

<dt>score.cache</dt>
<dd><p>the pre-computed cache of scores</p></dd>

<dt>num.searches</dt>
<dd><p>a numeric giving the number of random restart</p></dd>

<dt>max.steps</dt>
<dd><p>a numeric giving the maximal number of optimization steps within each search</p></dd>

<dt>algorithm</dt>
<dd><p>a character for indicating the algorithm used</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function is a flexible implementation of multiple greedy heuristic algorithms,
particularly well adapted to the <code>abn</code> framework.
It targets multi-random restarts heuristic algorithms.
The user can select the <code>num.searches</code> and the maximum number of steps
within by <code>max.steps</code>. The optimization algorithm within each search is
relatively rudimentary.</p>
<p>The function <code>searchHeuristic</code> is different from the
<code><a href="searchHillClimber.html">searchHillClimber</a></code> in the sense that this function is fully
written in R, whereas the <code><a href="searchHillClimber.html">searchHillClimber</a></code> is written in C
and thus expected to be faster. The function <code><a href="searchHillClimber.html">searchHillClimber</a></code>
at each hill-climbing step consider every information from the pre-computed
scores cache while the function <code>searchHeuristic</code> performs a local
stepwise optimization. This function chooses a structural move (or edge move)
and compute the score's change. On this point, it is closer to the MCMCMC
algorithm from Madigan and York (1995) and Giudici and Castelo (2003)
with a single edge move.</p>
<p>If the user select <code>random</code>, then a random valid DAG is selected.
The routine used favourise low density structure.
The function implements three algorithm selected with the
parameter <code>algo</code>: <code>hc</code>, <code>tabu</code> or <code>sa</code>.</p>
<p>If <code>algo=hc</code>:
The Hill-climber algorithm (<code>hc</code>) is a single move algorithm.
At each Hill-climbing step within a search an arc is attempted to be added.
The new score is computed and compared to the previous network's score.</p>
<p>If <code>algo=tabu</code>:
The same algorithm is as with <code>hc</code> is used, but a list of banned moves
is computed. The parameter <code>tabu.memory</code> controls the length of the tabu
list. The idea is that the classical Hill-climber algorithm is inefficient
when it should cross low probability regions to unblock from a local maximum
and reaching a higher score peak. By forcing the algorithm to choose some not
already used moves, this will force the algorithm to escape the local maximum.</p>
<p>If <code>algo=sa</code>:
This variant of the heuristic search algorithm is based on simulated annealing
described by Metropolis et al. (1953).
Some accepted moves could result in a decrease of the network score.
The acceptance rate can be monitored with the parameter <code>temperature</code>.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Heckerman, D., Geiger, D. and Chickering, D. M. (1995). Learning Bayesian networks: The combination of knowledge and statistical data. <em>Machine Learning</em>, 20, 197-243.
Madigan, D. and York, J. (1995) "Bayesian graphical models for discrete data". International Statistical Review, 63:215232.
Giudici, P. and Castelo, R. (2003). "Improving Markov chain Monte Carlo model search for data mining". Machine Learning, 50:127158.
Metropolis, N., Rosenbluth, A. W., Rosenbluth, M. N., Teller, A. H., &amp; Teller, E. (1953). "Equation of state calculations by fast computing machines". The journal of chemical physics, 21(6), 1087-1092.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="kw">if</span> <span class="op">(</span><span class="cn">FALSE</span><span class="op">)</span> <span class="op">{</span></span></span>
<span class="r-in"><span><span class="co">##############################################</span></span></span>
<span class="r-in"><span><span class="co">## example: use built-in simulated data set</span></span></span>
<span class="r-in"><span><span class="co">##############################################</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mydat</span> <span class="op">&lt;-</span> <span class="va">ex1.dag.data</span> <span class="co">## this data comes with abn see ?ex1.dag.data</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## setup distribution list for each node</span></span></span>
<span class="r-in"><span><span class="va">mydists</span><span class="op">&lt;-</span><span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>b1<span class="op">=</span><span class="st">"binomial"</span>, p1<span class="op">=</span><span class="st">"poisson"</span>, g1<span class="op">=</span><span class="st">"gaussian"</span>, b2<span class="op">=</span><span class="st">"binomial"</span>,</span></span>
<span class="r-in"><span>              p2<span class="op">=</span><span class="st">"poisson"</span>, b3<span class="op">=</span><span class="st">"binomial"</span>, g2<span class="op">=</span><span class="st">"gaussian"</span>, b4<span class="op">=</span><span class="st">"binomial"</span>,</span></span>
<span class="r-in"><span>              b5<span class="op">=</span><span class="st">"binomial"</span>, g3<span class="op">=</span><span class="st">"gaussian"</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="va">mycache</span> <span class="op">&lt;-</span> <span class="fu"><a href="buildScoreCache.html">buildScoreCache</a></span><span class="op">(</span>data.df <span class="op">=</span> <span class="va">mydat</span>, data.dists <span class="op">=</span> <span class="va">mydists</span>, max.parents <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Now peform 10 greedy searches</span></span></span>
<span class="r-in"><span><span class="va">heur.res</span> <span class="op">&lt;-</span> <span class="fu">searchHeuristic</span><span class="op">(</span>score.cache <span class="op">=</span> <span class="va">mycache</span>, data.dists <span class="op">=</span> <span class="va">mydists</span>,</span></span>
<span class="r-in"><span>                            start.dag <span class="op">=</span> <span class="st">"random"</span>, num.searches <span class="op">=</span> <span class="fl">10</span>,</span></span>
<span class="r-in"><span>                            max.steps <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co">## Plot (one) dag</span></span></span>
<span class="r-in"><span><span class="fu"><a href="plotAbn.html">plotAbn</a></span><span class="op">(</span><span class="va">heur.res</span><span class="op">$</span><span class="va">dags</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, data.dists <span class="op">=</span> <span class="va">mydists</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="op">}</span></span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matteo Delucchi, Reinhard Furrer, Gilles Kratzer, Fraser Iain Lewis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

