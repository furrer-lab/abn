<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en, de, fr"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="description" content="Find high scoring network (DAG) structures using a random re-starts greedy hill-climber heuristic search."><title>Find high scoring directed acyclic graphs using heuristic search. — searchHillClimber • abn</title><!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png"><link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png"><link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png"><link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png"><link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png"><link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- bootstrap-toc --><script src="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@v1.0.1/dist/bootstrap-toc.min.js" integrity="sha256-4veVQbu7//Lk5TSmc7YV48MxtMy98e26cf5MrgZYnwo=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- search --><script src="https://cdnjs.cloudflare.com/ajax/libs/fuse.js/6.4.6/fuse.js" integrity="sha512-zv6Ywkjyktsohkbp9bb45V6tEMoWhzFzXis+LrMehmJZZSys19Yxf1dopHx7WzIKxr5tK2dVcYmaCk2uqdjF4A==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/autocomplete.js/0.38.0/autocomplete.jquery.min.js" integrity="sha512-GU9ayf+66Xx2TmpxqJpliWbT5PiGYxpaG8rfnBEk1LL8l1KGkRShhngwdXK1UgqhAzWpZHSiYPc09/NwDQIGyg==" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/mark.min.js" integrity="sha512-5CYOlHXGh6QpOFA/TeTylKLWfB3ftPsde7AnmhuitiTX4K5SqCLBeKro6sPS8ilsz1Q4NRx3v8Ko2IBiszzdww==" crossorigin="anonymous"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Find high scoring directed acyclic graphs using heuristic search. — searchHillClimber"><meta property="og:description" content="Find high scoring network (DAG) structures using a random re-starts greedy hill-climber heuristic search."><meta property="og:image" content="http://r-bayesian-networks.org/logo.png"><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>
    

    <nav class="navbar fixed-top navbar-light navbar-expand-lg bg-light"><div class="container">
    
    <a class="navbar-brand me-2" href="../index.html">abn</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">3.0.6</small>

    
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item">
  <a class="nav-link" href="../reference/index.html">Reference</a>
</li>
<li class="nav-item dropdown">
  <a href="#" class="nav-link dropdown-toggle" data-bs-toggle="dropdown" role="button" aria-expanded="false" aria-haspopup="true" id="dropdown-articles">Articles</a>
  <div class="dropdown-menu" aria-labelledby="dropdown-articles">
    <a class="dropdown-item" href="../articles/quick_start_example.html">Quick Start Example</a>
    <a class="dropdown-item" href="../articles/model_specification.html">Model Specification: Build a Cache of Scores</a>
    <a class="dropdown-item" href="../articles/structure_learning.html">Bayesian Network Structure Learning</a>
    <a class="dropdown-item" href="../articles/parameter_learning.html">Parameter Learning</a>
    <a class="dropdown-item" href="../articles/mixed_effect_BN_model.html">Mixed-effect Bayesian Network Model</a>
    <a class="dropdown-item" href="../articles/data_simulation.html">Data Simulation</a>
    <a class="dropdown-item" href="../articles/multiprocessing.html">Parallelisation</a>
    <a class="dropdown-item" href="../articles/paper.html">Additive Bayesian Networks</a>
    <div class="dropdown-divider"></div>
    <a class="dropdown-item" href="../articles/index.html">More articles...</a>
  </div>
</li>
<li class="nav-item">
  <a class="nav-link" href="../news/index.html">Changelog</a>
</li>
      </ul><form class="form-inline my-2 my-lg-0" role="search">
        <input type="search" class="form-control me-sm-2" aria-label="Toggle navigation" name="search-input" data-search-index="../search.json" id="search-input" placeholder="Search for" autocomplete="off"></form>

      <ul class="navbar-nav"><li class="nav-item">
  <a class="external-link nav-link" href="https://github.com/furrer-lab/abn/" aria-label="github">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul></div>

    
  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Find high scoring directed acyclic graphs using heuristic search.</h1>
      <small class="dont-index">Source: <a href="https://github.com/furrer-lab/abn/blob/HEAD/R/search_hillclimber.R" class="external-link"><code>R/search_hillclimber.R</code></a></small>
      <div class="d-none name"><code>searchHillClimber.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Find high scoring network (DAG) structures using a random re-starts greedy hill-climber heuristic search.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">searchHillClimber</span><span class="op">(</span><span class="va">score.cache</span>, score <span class="op">=</span> <span class="st">"mlik"</span>, num.searches <span class="op">=</span> <span class="fl">1</span>, seed <span class="op">=</span> <span class="fl">42</span>,</span>
<span>                         start.dag <span class="op">=</span> <span class="cn">NULL</span>, support.threshold <span class="op">=</span> <span class="fl">0.5</span>, timing.on <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>                         dag.retained <span class="op">=</span> <span class="cn">NULL</span>, verbose <span class="op">=</span> <span class="cn">FALSE</span>, <span class="va">...</span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>
    <dl><dt>score.cache</dt>
<dd><p>output from <code><a href="buildScoreCache.html">buildScoreCache()</a></code>.</p></dd>


<dt>score</dt>
<dd><p>character giving which network score should be used to
select the structure. Currently <code>'mlik'</code> only.</p></dd>


<dt>num.searches</dt>
<dd><p>number of times to run the search.</p></dd>


<dt>seed</dt>
<dd><p>non-negative integer which sets the seed in the GSL random number generator.</p></dd>


<dt>start.dag</dt>
<dd><p>a DAG given as a matrix, see details for format, which can be used to provide a starting point for the structural search explicitly.</p></dd>


<dt>support.threshold</dt>
<dd><p>the proportion of search results - each locally optimal DAG - in which each arc must appear to be a part of the consensus network.</p></dd>


<dt>timing.on</dt>
<dd><p>extra output in terms of duration computation.</p></dd>


<dt>dag.retained</dt>
<dd><p>a DAG given as a matrix, see details for format. This is necessary if the score.cache was created using an explicit retain matrix, and the same retain matrix should be used here. dag.retained is used by the algorithm which generates the initial random DAG to ensure that the necessary arcs are retained.</p></dd>


<dt>verbose</dt>
<dd><p>extra output.</p></dd>


<dt>...</dt>
<dd><p>further arguments passed to or from other methods.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    

<p>A list with entries:</p><dl><dt>init.score</dt>
<dd><p>a vector giving network score for initial network from which the search commenced</p></dd>

<dt>final.score</dt>
<dd><p>a vector giving the network score for the locally optimal network</p></dd>

<dt>init.dag</dt>
<dd><p>list of matrices, initial DAGs</p></dd>

<dt>final.dag</dt>
<dd><p>list of matrices, locally optimal DAGs</p></dd>

<dt>consensus</dt>
<dd><p>a matrix holding a binary graph, not necessary a DAG!</p></dd>

<dt>support.threshold</dt>
<dd><p>percentage supported used to create consensus matrix</p></dd>


</dl></div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The procedure runs a greedy hill-climbing search similar, but not identical,
to the method presented initially in Heckerman et al. 1995.
(Machine Learning, 20, 197-243).
Each search begins with a randomly chosen DAG structure where this is
constructed in such a way as to attempt to choose a DAG uniformly from
the vast landscape of possible structures. The algorithm used is as follows:
given a node cache (from <code><a href="buildScoreCache.html">buildScoreCache</a></code>,
then within this set of all allowed local parent combinations,
a random combination is chosen for each node.
This is then combined into a full DAG, which is then checked for cycles,
where this check iterates over the nodes in a random order.
If all nodes have at least one child (i.e., at least one cycle is present),
then the first node examined has all its children removed, and the check for
cycles is then repeated. If this has removed the only cycle present,
then this DAG is used at the starting point for the search,
if not, a second node is chosen (randomly) and the process is then
repeated until a DAG is obtained.</p>
<p>The actual hill-climbing algorithm itself differs slightly from that presented
in Heckerman et al. as a full cache of all possible local combinations are available.
At each hill-climbing step, everything in the node cache is considered.
In other words, all possible single swaps between members of cache currently present
in the DAG and those in the full cache. The single swap, which provides the greatest
increase in goodness of fit is chosen. A single swap here is the removal
or addition of any one node-parent combination present in the cache while
avoiding a cycle. This means that as well as all single arc changes
(addition or removal), multiple arc changes are also considered at each same step,
note however that arc reversal in this scheme takes two steps (as this requires
first removal of a parent arc from one node and then addition of a parent arc
to a different node). The original algorithm perturbed the current DAG by only
a single arc at each step but also included arc reversal.
The current implementation may not be any more efficient than the original
but is arguably more natural given a pre-computed cache of local scores.</p>
<p>A start DAG may be provided in which case num.searches must
equal 1 - this option is really just to provide a local search
around a previously identified optimal DAG.</p>
<p>This function is designed for two different purposes:
i) interactive visualization; and
ii) longer batch processing. The former provides easy visual "eyeballing" of
data in terms of its majority consensus network (or similar threshold),
which is a graphical structure which comprises of all arcs which feature in
a given proportion (<code>support.threshold</code>) of locally optimal DAGs already
identified during the run. The general hope is that this structure will
stabilize - become fixed - relatively quickly, at least for problems with
smaller numbers of nodes.</p>
    </div>
    <div class="section level2">
    <h2 id="references">References<a class="anchor" aria-label="anchor" href="#references"></a></h2>
    <p>Lewis, F. I., and McCormick, B. J. J. (2012). Revealing the complexity of health determinants in resource poor settings. <em>American Journal Of Epidemiology</em>. DOI:10.1093/aje/KWS183).</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p></p><p>Developed by Matteo Delucchi, Reinhard Furrer, Gilles Kratzer, Fraser Iain Lewis.</p>
</div>

<div class="pkgdown-footer-right">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.0.7.</p>
</div>

    </footer></div>

  

  

  </body></html>

